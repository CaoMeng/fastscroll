(function(t,i,s){var o=t.requestAnimationFrame||t.webkitRequestAnimationFrame||function(i){t.setTimeout(i,1e3/60)};var n="ontouchstart"in t,e=n?"touchstart":"mousedown",r=n?"touchmove":"mousemove",l=n?"touchend":"mouseup",h=n?"touchcancel":"mouseup";function a(){return(new Date).getTime()}function c(t,i,o,n,e,r){var l=t-i,h=s.abs(l)/o,a,c;r=r===undefined?6e-4:r;a=t+h*h/(2*r)*(l<0?-1:1);c=h/r;if(a<n){a=e?n-e/2.5*(h/8):n;l=s.abs(a-t);c=l/h}else if(a>0){a=e?e/2.5*(h/8):0;l=s.abs(t)+a;c=l/h}return{destination:s.round(a),duration:c}}var u={quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return s.sqrt(1- --t*t)}}};function p(t,s){if(t.charAt&&t.charAt(0)=="#"){t=t.substr(1,t.length-1)}this.wrapper=typeof t=="string"?i.getElementById(t):t;this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this._events={};this.options={momentum:true,bounce:true,deceleration:undefined,bounceTime:600,startX:0,startY:0,scrollX:false,scrollY:true,directionLockThreshold:5,onfunction:function(t){t.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:function(){console.log("ScrollY::",this.y)},onBeforeScrollEnd:null,onScrollEnd:null,useTransition:true};for(var o in s){this.options[o]=s[o]}this.options.bounceEasing=u.circular;if(this.options.probeType==3){this.options.useTransition=false}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this.translateZ=" translateZ(0)";this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY)}p.prototype={refresh:function t(){console.log("refresh");var i=this;var o=this.options.wrapperWidth;var n=this.options.wrapperHeight;var e=this.options.scrollerWidth;var r=this.options.scrollerHeight;i.wrapperW=o||i.wrapper.clientWidth||1;i.wrapperH=n||i.wrapper.clientHeight||1;this.wrapperWidth=o||this.wrapper.clientWidth;this.wrapperHeight=n||this.wrapper.clientHeight;i.minScrollY=-i.options.topOffset||0;i.scrollerW=e||s.round(i.scroller.offsetWidth);i.scrollerH=r||s.round(i.scroller.offsetHeight+i.minScrollY);i.maxScrollX=i.wrapperW-i.scrollerW;i.maxScrollY=i.wrapperH-i.scrollerH+i.minScrollY;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}i.endTime=0;i.directionX=0;i.directionY=0;if(i.options.onRefresh)i.options.onRefresh.call(i);i._resetPos()},getComputedPosition:function(){var i=t.getComputedStyle(this.scroller,null),s,o;console.log("getComputedPosition------",i.webkitTransform);i=i.webkitTransform.split(")")[0].split(", ");s=+(i[12]||i[4]);o=+(i[13]||i[5]);return{x:s,y:o}},_init:function(){this._initEvents()},_initEvents:function(){this._bind(e)},_onStart:function t(i){console.log("_onStart");var o=this;var n=i.target;while(n.nodeType!=1)n=n.parentNode;if(n.tagName!="SELECT"&&n.tagName!="INPUT"&&n.tagName!="TEXTAREA"){i.preventDefault()}if(this.options.onBeforeScrollStart)this.options.onBeforeScrollStart.call(this,i);this._execEvent("beforeScrollStart");this.moved=false;var e=i.touches?i.touches[0]:i;this.distX=0;this.distY=0;this.directionLocked=0;this.startTime=a();this._transitionTime();this.startX=this.x;this.startY=this.y;this.pointX=e.pageX;this.pointY=e.pageY;if(this.options.useTransition&&this.isInTransition){console.log("--------------in transition............",this.scrollerStyle.webkitTransitionDuration);o.isInTransition=false;var c=o.getComputedPosition();o._translate(s.round(c.x),s.round(c.y));o.startX=o.x;o.startY=o.y}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}if(this.options.onScrollStart)this.options.onScrollStart.call(this,i);this._execEvent("scrollStart");this._bind(r);this._bind(l);this._bind(h);this._bind("webkitTransitionEnd")},_onMove:function t(i){console.log("_onMove");var o=this;i.preventDefault();var n=i.touches?i.touches[0]:i;var e=n.pageX-this.pointX;var r=n.pageY-this.pointY;if(o.options.onBeforeScrollMove)o.options.onBeforeScrollMove.call(o,i);this._execEvent("beforeScrollMove");var l=a();var h,c,u,p;this.pointX=n.pageX;this.pointY=n.pageY;this.distX+=e;this.distY+=r;h=s.abs(this.distX);c=s.abs(this.distY);if(h>c+this.options.directionLockThreshold){this.directionLocked="h"}else if(c>=h+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}if(this.directionLocked=="h"){r=0}else if(this.directionLocked=="v"){e=0}e=this.hasHorizontalScroll?e:0;r=this.hasVerticalScroll?r:0;u=this.x+e;p=this.y+r;if(l-this.endTime>300&&(h<10&&c<10)){return}if(u>0||u<o.maxScrollX){u=o.options.bounce?o.x+e/3:u>=0||o.maxScrollX>=0?0:o.maxScrollX}if(p>this.minScrollY||p<this.maxScrollY){p=this.options.bounce?this.y+r/3:p>=this.minScrollY||this.maxScrollY>=0?this.minScrollY:this.maxScrollY}this.moved=true;this._translate(u,p);this.directionY=r>0?-1:r<0?1:0;if(l-this.startTime>300){this.startTime=l;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent("scroll")}}if(this.options.probeType>1){this._execEvent("scroll")}if(this.options.onScrollMove)this.options.onScrollMove.call(this,i);this._execEvent("scrollMove")},_onEnd:function t(i){console.log("_onEnd");var o=this;this.isInTransition=0;var n=s.round(this.x);var e=s.round(this.y);var p=s.abs(n-this.startX);var f=s.abs(e-this.startY);var d=a()-this.startTime;this._unbind(r);this._unbind(l);this._unbind(h);var m="";if(o.options.onBeforeScrollEnd)o.options.onBeforeScrollEnd.call(o,i);this._execEvent("beforeScrollEnd");this.endTime=a();if(this._resetPos(this.options.bounceTime)){return}this.scrollTo(n,e);if(!this.moved){console.log("---------onScrollCancel");if(this.options.onScrollCancel)this.options.onScrollCancel.call(this,i);this._execEvent("scrollCancel");return}console.log("flick::",d,p,f);console.log("======",this.options.momentum,d);if(this.options.momentum&&d<300){var v=this.hasHorizontalScroll?c(this.x,this.startX,d,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:n,duration:0};var S=this.hasVerticalScroll?c(this.y,this.startY,d,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:e,duration:0};n=v.destination;e=S.destination;console.log("_onEnd::newY:",e);console.log(this.y,this.startY,d,this.maxScrollY,this.options.bounce);var _=s.max(v.duration,S.duration);this.isInTransition=1}if(n!=this.x||e!=this.y){if(n>0||n<this.maxScrollX||e>0||e<this.maxScrollY){m=u.quadratic}this.scrollTo(n,e,_,m);return}},scrollTo:function t(i,s,o,n){n=n||u.circular;this.isInTransition=o>0;if(!o||this.options.useTransition&&n.style){this._transitionTimingFunction(n.style);this._transitionTime(o);this._translate(i,s)}else{this._animate(i,s,o,n.fn)}},_translate:function t(i,s){console.log("_translate::",this.scrollerStyle.webkitTransitionDuration);this.scrollerStyle.webkitTransform="translate("+i+"px,"+s+"px)"+this.translateZ;this.x=i;this.y=s},_transitionTime:function t(i){i=i||0;this.scrollerStyle.webkitTransitionDuration=i+"ms"},_transitionTimingFunction:function t(i){this.scrollerStyle.webkitTransitionTimingFunction=i},_bind:function t(i,s,o){(s||this.scroller).addEventListener(i,this,!!o)},_unbind:function t(i,s,o){(s||this.scroller).removeEventListener(i,this,!!o)},handleEvent:function(t){var i=this;switch(t.type){case e:i._onStart(t);break;case r:i._onMove(t);break;case l:case h:i._onEnd(t);break;case"webkitTransitionEnd":i._onTransitionEnd(t);break}},_onTransitionEnd:function(t){console.log("_onTransitionEnd");if(t.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this._resetPos(this.options.bounceTime)){this.isInTransition=false;this._unbind("webkitTransitionEnd");if(this.options.onScrollEnd)this.options.onScrollEnd.call(this);this._execEvent("scrollEnd");if(this.options.probeType){this._execEvent("scroll")}}},_resetPos:function(t){console.log("_resetPos");var i=this.x,s=this.y;t=t||0;if(!this.hasHorizontalScroll||this.x>0){i=0}else if(this.x<this.maxScrollX){i=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){s=0}else if(this.y<this.maxScrollY){s=this.maxScrollY}if(i==this.x&&s==this.y){return false}console.log("-----3------");this.scrollTo(i,s,t,this.options.bounceEasing);return true},on:function(t,i){if(!this._events[t]){this._events[t]=[]}this._events[t].push(i)},_execEvent:function(t){console.log("_execEvent:",t);if(!this._events[t]){return}var i=0,s=this._events[t].length;if(!s){return}for(;i<s;i++){this._events[t][i].apply(this,[].slice.call(arguments,1))}},_animate:function(t,i,s,n){var e=this,r=this.x,l=this.y,h=a(),c=h+s;function u(){var p=a(),f,d,m;if(p>=c){e.isAnimating=false;e._translate(t,i);if(!e._resetPos(e.options.bounceTime)){e._execEvent("scrollEnd")}return}p=(p-h)/s;m=n(p);f=(t-r)*m+r;d=(i-l)*m+l;e._translate(f,d);if(e.isAnimating){o(u)}if(e.options.probeType==3){e._execEvent("scroll")}}this.isAnimating=true;u()}};t.FastScroll=t.fs=t.FS=t.is=t.IS=p;if(!t.IScroll){t.IScroll=p}})(window,document,Math);